!function e(t,n,o){function r(i,s){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){var n=t[i][1][e];return r(n?n:e)},l,l.exports,e,t,n,o)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<o.length;i++)r(o[i]);return r}({1:[function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}var r=e("./states"),a=o(r);otsimo.onSettingsChanged(function(e,t){otsimo.game.sound.mute=!t}),otsimo.run(function(){var e=new Phaser.Game(otsimo.width,otsimo.height,Phaser.CANVAS,"gameContainer");Object.keys(a).forEach(function(t){return e.state.add(t,a[t])}),otsimo.game=e,e.state.start("Boot")})},{"./states":12}],2:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=e("../randomColor"),u=function(e){function t(e){var n=e.game,a=e.x,i=e.y,s=e.color;o(this,t);var u=r(this,Object.getPrototypeOf(t).call(this,n));u.x=a,u.y=i,u.create(55,197,"ballon_rope");var c=u.create(0,0,"ballon_body");return u.create(80,13,"ballon_light"),c.tint=s,c.inputEnabled=!0,c.events.onInputDown.add(u.bodyTouched,u),u.bodySprite=c,u}return a(t,e),i(t,[{key:"bodyTouched",value:function(e,t){var n=otsimo.game.add.emitter(t.x,t.y,100);n.makeParticles("ballon_star"),n.gravity=500,n.setYSpeed(-500,0),n.width=.6*this.bodySprite.width,n.height=.3*this.bodySprite.width,n.start(!0,4e3,null,10),otsimo.game.time.events.add(4e3,n.destroy,n),n.forEach(function(e,t){e.tint=t},this,!0,this.bodySprite.tint),this.destroy(!0)}},{key:"randomScale",value:function(){var e=.75*Math.random()+.5;this.scale.x=e,this.scale.y=e}},{key:"moveRandomly",value:function(){var e=300*Math.random()-150,t=this.x+e;0>t&&(t=0),t>otsimo.game.width-150*this.scale.y&&(t=otsimo.game.width-175*this.scale.y);var n=otsimo.game.add.tween(this).to({x:t,y:-260*this.scale.y},6e3+4e3*Math.random(),"Linear",!0,400*Math.random());n.onComplete.add(function(){this.destroy(!0)},this)}}],[{key:"random",value:function(){var e=(0,s.randomColor)(otsimo.kv.game.balloon_options),n=!0,o=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var u=a.value,c=50+Math.random()*otsimo.game.width*.8,l=otsimo.game.height+200*Math.random(),h=parseInt(u.replace("#","0x"),16),f=new t({game:otsimo.game,x:c,y:l,color:h});f.randomScale(),f.moveRandomly()}}catch(d){o=!0,r=d}finally{try{!n&&i["return"]&&i["return"]()}finally{if(o)throw r}}}}]),t}(Phaser.Group);n["default"]=u},{"../randomColor":6}],3:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=e("../utils"),u=function(e){function t(e){var n=e.game,a=e.question;o(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,n));return i.onComplete=new Phaser.Signal,i.question=a,i.currentPage=0,i}return a(t,e),i(t,[{key:"_addOnPageCompleted",value:function(e,t){var n=this,o=otsimo.kv.play_screen.intro;e.onComplete.addOnce(function(){var e=null,r=!0,a=!1,i=void 0;try{for(var s,u=t[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;e=otsimo.game.add.tween(c).to({alpha:0},o.text_enter_duration,Phaser.Easing.Cubic.Out,!1,4*o.duration_each),e.start()}}catch(l){a=!0,i=l}finally{try{!r&&u["return"]&&u["return"]()}finally{if(a)throw i}}n.currentPage=n.currentPage+1,n.currentPage<n.pageTweens.length?e.chain(n.pageTweens[n.currentPage]):e.onComplete.addOnce(function(){n.onComplete.dispatch()},n)},this)}},{key:"show",value:function(){var e=this.question,t=otsimo.kv.play_screen.intro,n=(0,s.calculateConstraint)(t.question_constraint),o=this.create(n.x,-otsimo.game.height,e.object_img,e.object_frame);o.anchor.set(n.anchor.x,n.anchor.y);var r=otsimo.game.add.tween(o).to({y:n.y},300,Phaser.Easing.Cubic.Out);this.pageTweens=[r];for(var a=0;a<t.pages.length;a++){var i=null,u=[],c=!0,l=!1,h=void 0;try{for(var f,d=t.pages[a][Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value,m=(0,s.calculateConstraint)(p.position),g=sprintf(p.text,e),y=t.styles[p.style],v=otsimo.game.add.text(m.x,m.y,g,y,this);v.audio=sprintf(p.audio,e),v.anchor.set(.5,.5),v.alpha=0;var b=otsimo.game.add.tween(v).to({alpha:1},t.text_enter_duration,Phaser.Easing.Cubic.Out,!1,t.duration_each);i?i.chain(b):(1==this.pageTweens.length&&r.chain(b),this.pageTweens.push(b)),i=b,u.push(v)}}catch(w){l=!0,h=w}finally{try{!c&&d["return"]&&d["return"]()}finally{if(l)throw h}}this._addOnPageCompleted(i,u)}this.objectImage=o,this.pageTweens[this.currentPage].start(),this.currentPage=this.currentPage+1}},{key:"hide",value:function(){var e=this.objectImage,t=otsimo.game.add.tween(e).to({x:otsimo.game.width+e.width},300,Phaser.Easing.Cubic.In,!0);t.onComplete.addOnce(this.destroy,this)}},{key:"makeObjectImageSmall",value:function(){var e=(0,s.calculateConstraint)(otsimo.kv.play_screen.intro.question_small_constraint),t=this.objectImage,n=otsimo.kv.play_screen.intro.question_small_size,o=0|n.width.constant,r=0|n.height.constant,a=n.width.multiplier*otsimo.game.width+o,i=n.height.multiplier*otsimo.game.height+r,u=t.scale.x;t.width>a&&(u=a/t.width),t.height*u>i&&(u=i/(t.height*u)),Math.abs(u-t.scale.x)>.001&&otsimo.game.add.tween(t.scale).to({x:u,y:u},300,Phaser.Easing.Cubic.Out,!0),otsimo.game.add.tween(t).to({x:e.x,y:e.y},300,Phaser.Easing.Cubic.Out,!0),e.anchor.x==t.anchor.x&&e.anchor.y==t.anchor.y||otsimo.game.add.tween(t.anchor).to({x:e.anchor.x,y:e.anchor.y},300,Phaser.Easing.Cubic.Out,!0)}},{key:"goRightForEnding",value:function(){var e=(this.question,otsimo.kv.play_screen.intro),t=(0,s.calculateConstraint)(e.question_constraint),n=this.objectImage;otsimo.game.add.tween(n).to({x:t.x,y:t.y},300,Phaser.Easing.Cubic.Out,!0),otsimo.game.add.tween(n.scale).to({x:1,y:1},300,Phaser.Easing.Cubic.Out,!0),otsimo.game.add.tween(n.anchor).to({x:t.anchor.x,y:t.anchor.y},300,Phaser.Easing.Cubic.Out,!0)}}]),t}(Phaser.Group);n["default"]=u},{"../utils":16}],4:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){var n=t.x-30,o=t.y-30,r=t.x+30,a=t.y+30,i=!1;return e.x>=n&&e.x<=r&&e.y>=o&&e.y<=a&&(i=!0),i}function s(e){var t=otsimo.game.add.tween(e),n=otsimo.starPos.x-otsimo.game.width/2+Math.random()*otsimo.kv.play_screen.bucket_star_width,o=otsimo.starPos.y-otsimo.game.height/2+Math.random()*otsimo.kv.play_screen.bucket_star_height;t.to({y:o,x:n},300),t.start()}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=e("../utils"),l=e("./painting"),h=function(e){function t(e){var n=e.game,a=e.item;o(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,n));i.item=a;var s=(0,c.calculateConstraint)(otsimo.kv.play_screen.paint_constraint),u=i.create(0,0,a.image,a.frame);return u.anchor.set(.5,.5),i.hiddenPos=new Phaser.Point(s.x,otsimo.game.height+u.height),i.visiblePos=new Phaser.Point(s.x,s.y),i.x=i.hiddenPos.x,i.y=i.hiddenPos.y,i.sprite=u,i.currentStep=0,i.drawSteps(),i.onFinishDrawing=new Phaser.Signal,i}return a(t,e),u(t,[{key:"init",value:function(){var e=this;this.paint=new l.OtsimoPainting({game:otsimo.game,parent:this}),this.paint.onfinishdrawing=function(t){e.checkDrawing(t)}}},{key:"moveIn",value:function(){otsimo.game.add.tween(this).to({x:this.visiblePos.x,y:this.visiblePos.y},300,Phaser.Easing.Cubic.Out,!0)}},{key:"moveOut",value:function(){var e=otsimo.game.add.tween(this).to({y:this.hiddenPos.y},300,Phaser.Easing.Cubic.In,!0);e.onComplete.addOnce(this.destroy,this)}},{key:"goLeftForEnding",value:function(){otsimo.game.add.tween(this).to({x:this.visiblePos.x/2,y:this.visiblePos.y},300,Phaser.Easing.Cubic.Out,!0),otsimo.game.add.tween(this.scale).to({x:.7,y:.7},300,Phaser.Easing.Cubic.Out,!0)}},{key:"drawSteps",value:function(){var e=this.item.steps[this.currentStep];this.stepGroup=[];for(var t=0;t<e.length;++t){var n=e[t].x,o=e[t].y,r="star_middle.png";0!=t&&t!=e.length-1||(r="start_end.png");var a=otsimo.game.add.image(n-this.sprite.width/2,o-this.sprite.height/2,"atlas",r,this);a.anchor.set(.5,.5),this.bringToTop(a),this.stepGroup.push(a)}}},{key:"checkDrawing",value:function(e){for(var t=this.item.steps[this.currentStep],n=[],o=0;o<t.length;o++)n.push(!1);for(var r=1;r<e.points.length;r++)for(var a=e.points[r-1],s=e.points[r],u=(0,l.distanceBetween)(a,s),c=(0,l.angleBetween)(a,s),h=0;u>h;h++)for(var f=a.x+Math.sin(c)*h,d=a.y+Math.cos(c)*h,p=0;p<t.length;p++){var m=t[p],g=otsimo.game.world.centerX-this.sprite.width/2+m.x,y=otsimo.game.world.centerY-this.sprite.height/2+m.y;i({x:f,y:d},{x:g,y:y})&&(n[p]=!0)}for(var v=0;v<t.length;v++)if(n[v]===!1)return this.paint.clearCtx(),void this.paint.newStep();this.finishStep()}},{key:"finishStep",value:function(){this.finishAnim(),this.currentStep+1<this.item.steps.length?(this.paint.newStep(),this.currentStep+=1,this.drawSteps()):this.finishGame()}},{key:"finishAnim",value:function(){for(var e=0;e<this.stepGroup.length;e++)s(this.stepGroup[e]);this.stepGroup=[]}},{key:"finishGame",value:function(){this.onFinishDrawing.dispatch()}}]),t}(Phaser.Group);n["default"]=h},{"../utils":16,"./painting":5}],5:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){var t=otsimo.game.add.bitmapData(otsimo.game.width,otsimo.game.height),n=otsimo.game.add.sprite(0,0,t,null,e);n.anchor.set(.5,.5);var o=t.context;return o.lineJoin=o.lineCap="round",o.globalAlpha=.2,{points:[],bitmap:t,ctx:o,lastPoint:{x:0,y:0}}}function a(e){var t=e.ctx;e.points=[],t.clearRect(0,0,t.canvas.width,t.canvas.height),e.bitmap.destroy()}function i(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function s(e,t){return Math.atan2(t.x-e.x,t.y-e.y)}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();n.OtsimoPainting=function(){function e(t){var n=t.game,a=t.parent;o(this,e),this.game=n,this.parentGroup=a,this.drawing=!1,this.steps=[],this.onfinishdrawing=null,this.steps.push(r(a)),this.game.input.addMoveCallback(this.input.bind(this))}return u(e,[{key:"getLastStep",value:function(){return this.steps[this.steps.length-1]}},{key:"input",value:function(e,t,n){!this.drawing&&e.isDown?(this.drawing=!0,this.onDown(e,t,n)):this.drawing&&e.isDown?this.onMove(e,t,n):this.drawing&&e.isUp&&this.onUp(e,t,n)}},{key:"newStep",value:function(){this.steps.push(r(this.parentGroup))}},{key:"clearCtx",value:function(){var e=this.getLastStep();a(e),this.steps.pop()}},{key:"clear",value:function(){this.game.input.deleteMoveCallback(this.input)}},{key:"onDown",value:function(e,t,n){var o=this.getLastStep();o.lastPoint={x:t,y:n},o.points.push(o.lastPoint)}},{key:"onMove",value:function(e,t,n){var o=this.getLastStep(),r={x:t,y:n},a=i(o.lastPoint,r),u=s(o.lastPoint,r),c=o.ctx;o.points.push(r);for(var l=0;a>l;l+=5){t=o.lastPoint.x+Math.sin(u)*l,n=o.lastPoint.y+Math.cos(u)*l;var h=c.createRadialGradient(t,n,15,t,n,30);h.addColorStop(0,"#FFFF00"),h.addColorStop(.5,"rgba(255,255,0,0.5)"),h.addColorStop(1,"rgba(255,255,0,0)"),c.fillStyle=h,c.fillRect(t-30,n-30,60,60)}o.lastPoint=r}},{key:"onUp",value:function(e,t,n){this.drawing=!1,this.onfinishdrawing&&this.onfinishdrawing(this.getLastStep())}}]),e}();n.distanceBetween=i,n.angleBetween=s},{}],6:[function(e,t,n){"use strict";function o(e){var t=u(e.hue),n=h(t);return 0>n&&(n=360+n),n}function r(e,t){if("random"===t.luminosity)return h([0,100]);if("monochrome"===t.hue)return 0;var n=c(e),o=n[0],r=n[1];switch(t.luminosity){case"bright":o=55;break;case"dark":o=r-10;break;case"light":r=55}return h([o,r])}function a(e,t,n){var o=s(e,t),r=100;switch(n.luminosity){case"dark":r=o+20;break;case"light":o=(r+o)/2;break;case"random":o=0,r=100}return h([o,r])}function i(e,t){switch(t.format){case"hsvArray":return e;case"hslArray":return g(e);case"hsl":var n=g(e);return"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)";case"hsla":var o=g(e);return"hsla("+o[0]+", "+o[1]+"%, "+o[2]+"%, "+Math.random()+")";case"rgbArray":return m(e);case"rgb":var r=m(e);return"rgb("+r.join(", ")+")";case"rgba":var a=m(e);return"rgba("+a.join(", ")+", "+Math.random()+")";default:return f(e)}}function s(e,t){for(var n=l(e).lowerBounds,o=0;o<n.length-1;o++){var r=n[o][0],a=n[o][1],i=n[o+1][0],s=n[o+1][1];if(t>=r&&i>=t){var u=(s-a)/(i-r),c=a-u*r;return u*t+c}}return 0}function u(e){if("number"==typeof parseInt(e)){var t=parseInt(e);if(360>t&&t>0)return[t,t]}if("string"==typeof e&&b[e]){var n=b[e];if(n.hueRange)return n.hueRange}return[0,360]}function c(e){return l(e).saturationRange}function l(e){e>=334&&360>=e&&(e-=360);for(var t in b){var n=b[t];if(n.hueRange&&e>=n.hueRange[0]&&e<=n.hueRange[1])return b[t]}return"Color not found"}function h(e){if(null===v)return Math.floor(e[0]+Math.random()*(e[1]+1-e[0]));var t=e[1]||1,n=e[0]||0;v=(9301*v+49297)%233280;var o=v/233280;return Math.floor(n+o*(t-n))}function f(e){function t(e){var t=e.toString(16);return 1==t.length?"0"+t:t}var n=m(e),o="#"+t(n[0])+t(n[1])+t(n[2]);return o}function d(e,t,n){var o=n[0][0],r=n[n.length-1][0],a=n[n.length-1][1],i=n[0][1];b[e]={hueRange:t,lowerBounds:n,saturationRange:[o,r],brightnessRange:[a,i]}}function p(){d("monochrome",null,[[0,0],[100,0]]),d("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),d("orange",[19,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),d("yellow",[47,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),d("green",[63,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),d("blue",[179,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),d("purple",[258,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),d("pink",[283,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function m(e){var t=e[0];0===t&&(t=1),360===t&&(t=359),t/=360;var n=e[1]/100,o=e[2]/100,r=Math.floor(6*t),a=6*t-r,i=o*(1-n),s=o*(1-a*n),u=o*(1-(1-a)*n),c=256,l=256,h=256;switch(r){case 0:c=o,l=u,h=i;break;case 1:c=s,l=o,h=i;break;case 2:c=i,l=o,h=u;break;case 3:c=i,l=s,h=o;break;case 4:c=u,l=i,h=o;break;case 5:c=o,l=i,h=s}var f=[Math.floor(255*c),Math.floor(255*l),Math.floor(255*h)];return f}function g(e){var t=e[0],n=e[1]/100,o=e[2]/100,r=(2-n)*o;return[t,Math.round(n*o/(1>r?r:2-r)*1e4)/100,r/2*100]}function y(e){for(var t=0,n=0;n!==e.length&&!(t>=Number.MAX_SAFE_INTEGER);n++)t+=e.charCodeAt(n);return t}Object.defineProperty(n,"__esModule",{value:!0});var v=null,b={};p();var w=function _(e){if(e=e||{},e.seed&&e.seed===parseInt(e.seed,10))v=e.seed;else if("string"==typeof e.seed)v=y(e.seed);else{if(void 0!==e.seed&&null!==e.seed)throw new TypeError("The seed value must be an integer or string");v=null}var t,n,s;if(null!==e.count&&void 0!==e.count){var u=e.count,c=[];for(e.count=null;u>c.length;)v&&e.seed&&(e.seed+=1),c.push(_(e));return e.count=u,c}return t=o(e),n=r(t,e),s=a(t,n,e),i([t,n,s],e)};n.randomColor=w},{}],7:[function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();n.Randomizer=function(){function e(){r(this,e);var t=new Set,n=otsimo.kv[otsimo.kv.game.items],o=!0,a=!1,i=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;t.add(c.kind)}}catch(l){a=!0,i=l}finally{try{!o&&u["return"]&&u["return"]()}finally{if(a)throw i}}this.itemList=n,this.values=new Set(t.values()),this.kinds=t}return a(e,[{key:"randomKind",value:function(){var e=Math.floor(Math.random()*this.values.size);return[].concat(o(this.values))[e]}},{key:"randomItemOfKind",value:function(e,t,n){var r=[].concat(o(e)).filter(function(e){return null!=t&&e.kind!=t?!1:!(null!=n&&n.indexOf(e.kind)>=0)});return r[Math.floor(Math.random()*r.length)]}},{key:"next",value:function(e){0==this.values.size&&(this.values=new Set(this.kinds.values()));var t=this.randomKind();this.values["delete"](t);var n=this.randomItemOfKind(this.itemList,t,[]);return e(n)}}]),e}()},{}],8:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=e("./randomizer"),s=e("./prefabs/intro"),u=o(s),c=e("./utils"),l=e("./prefabs/paint"),h=o(l),f=function(){function e(t){var n=t.session,o=t.delegate;r(this,e),this.session=n,this.delegate=o,this._random=new i.Randomizer,this.steps=[],this.step=0}return a(e,[{key:"next",value:function(){var e=this;return this.step=this.step+1,this.step>=otsimo.kv.game.session_step?!1:(this.random.next(function(t){e.answerItem=t;var n=new u["default"]({game:otsimo.game,question:t});e.intro=n,n.onComplete.addOnce(e.onIntroCompleted,e),n.show()}),!0)}},{key:"onIntroCompleted",value:function(){this.intro.makeObjectImageSmall(),this.show()}},{key:"show",value:function(){var e=new h["default"]({game:otsimo.game,item:this.answerItem});e.init(),e.moveIn(),e.onFinishDrawing.addOnce(this.onFinishDrawing,this),this.paint=e,this.showBasket()}},{key:"showBasket",value:function(){var e=(0,c.calculateConstraint)(otsimo.kv.play_screen.bucket_constraint),t=otsimo.game.add.image(e.x,e.y,otsimo.kv.play_screen.bucket.atlas_or_image,otsimo.kv.play_screen.bucket.frame);t.y=otsimo.game.height+t.height,t.anchor=e.anchor,otsimo.game.world.bringToTop(t),otsimo.game.add.tween(t).to({y:e.y},300,Phaser.Easing.Cubic.Out,!0);var n=new Phaser.Point(e.x,e.y);n.y=n.y+otsimo.kv.play_screen.bucket_star_y*t.height,n.x=n.x+otsimo.kv.play_screen.bucket_star_x*t.width,otsimo.starPos=n,this.bucket=t}},{key:"hideBasket",value:function(){var e=otsimo.game.add.tween(this.bucket).to({y:otsimo.game.height+this.bucket.height},300,Phaser.Easing.Cubic.In,!0);e.onChildComplete.addOnce(this.bucket.destroy,this.bucket)}},{key:"showEnding",value:function(){var e=this;this.intro.goRightForEnding(),this.paint.goLeftForEnding(),this.hideBasket(),setTimeout(function(){e.paint.moveOut(),e.intro.hide()},1500),setTimeout(function(){e.next()||e.game.state.start("Over")},2e3)}},{key:"onFinishDrawing",value:function(){var e=this;setTimeout(function(){e.showEnding()},400)}},{key:"random",get:function(){return this._random}},{key:"step",get:function(){return 0|this.current_step},set:function(e){this.current_step=e}}]),e}();n["default"]=f},{"./prefabs/intro":3,"./prefabs/paint":4,"./randomizer":7,"./utils":16}],9:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=function(){function e(t){var n=t.state;o(this,e),this.score=0,this.startTime=new Date,this.state=n,this.wrongAnswerTotal=0,this.wrongAnswerStep=0}return r(e,[{key:"end",value:function(){console.log("end session, post to analytics")}},{key:"startStep",value:function(){this.wrongAnswerStep=0,console.log("start step")}},{key:"wrongInput",value:function(e,t){this.wrongAnswerStep+=1,this.wrongAnswerTotal+=1,console.log("wrong input")}},{key:"correctInput",value:function(e,t){console.log("correct input")}},{key:"debug",value:function(e){e.debug.text("score: "+this.score,2,28,"#00ff00"),e.debug.text("wrongAnswerTotal: "+this.wrongAnswerTotal,2,42,"#00ff00"),e.debug.text("wrongAnswerStep: "+this.wrongAnswerStep,2,54,"#00ff00")}}]),e}();n["default"]=a},{}],10:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=function(e){function t(){return o(this,t),r(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),i(t,[{key:"preload",value:function(){otsimo.kv.loading_screen.only_image&&this.load.image("preloader",otsimo.kv.loading_screen.image_path)}},{key:"create",value:function(){this.game.input.maxPointers=1,this.game.stage.backgroundColor=otsimo.kv.loading_screen.background_color,this.game.device.desktop?this.game.scale.pageAlignHorizontally=!0:(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=1024,this.game.scale.minHeight=768,this.game.scale.maxWidth=1024,this.game.scale.maxHeight=768,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0),this.game.state.start("Preloader")}}]),t}(Phaser.State);n["default"]=s},{}],11:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=e("../prefabs/balloon"),c=(o(u),e("../utils")),l=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),s(t,[{key:"create",value:function(){if(otsimo.kv.home_screen.background_color&&(this.game.stage.backgroundColor=otsimo.kv.home_screen.background_color),otsimo.kv.home_screen.background_image){var e=this.game.add.image(this.game.world.centerX,this.game.world.centerY,otsimo.kv.home_screen.background_image);e.anchor.set(.5,.5)}var t=(0,c.calculateConstraint)(otsimo.kv.home_screen.play_btn_constraint),n=this.game.add.button(t.x,t.y,"playButton",this.playAction,this,2,1,0);n.anchor=otsimo.kv.home_screen.play_btn_constraint.anchor;var o=(0,c.calculateConstraint)(otsimo.kv.game.back_btn_constraint);this.game.add.button(o.x,o.y,otsimo.kv.game.back_btn_image,otsimo.quitgame,this)}},{key:"playAction",value:function(){this.game.state.start("Play")}},{key:"render",value:function(){otsimo.debug&&this.game.debug.text(this.game.time.fps||"--",2,14,"#00ff00")}}]),t}(Phaser.State);n["default"]=l},{"../prefabs/balloon":2,"../utils":16}],12:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./home");Object.defineProperty(n,"Home",{enumerable:!0,get:function(){return o(r)["default"]}});var a=e("./preloader");Object.defineProperty(n,"Preloader",{enumerable:!0,get:function(){return o(a)["default"]}});var i=e("./over");Object.defineProperty(n,"Over",{enumerable:!0,get:function(){return o(i)["default"]}});var s=e("./play");Object.defineProperty(n,"Play",{enumerable:!0,get:function(){return o(s)["default"]}});var u=e("./boot");Object.defineProperty(n,"Boot",{enumerable:!0,get:function(){return o(u)["default"]}})},{"./boot":10,"./home":11,"./over":13,"./play":14,"./preloader":15}],13:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=e("../prefabs/balloon"),c=o(u),l=e("../utils"),h=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),s(t,[{key:"create",value:function(){if(otsimo.kv.over_screen.background_color&&(this.game.stage.backgroundColor=otsimo.kv.over_screen.background_color),otsimo.kv.over_screen.background_image){var e=this.game.add.image(this.game.world.centerX,this.game.world.centerY,otsimo.kv.over_screen.background_image);e.anchor.set(.5,.5)}this.game.add.button(.37*this.game.width,.47*this.game.height,"playButton",this.playAction,this);var t=(0,l.calculateConstraint)(otsimo.kv.game.back_btn_constraint);this.game.add.button(t.x,t.y,otsimo.kv.game.back_btn_image,this.backAction,this),c["default"].random()}},{key:"playAction",value:function(){this.game.state.start("Play")}},{key:"backAction",value:function(){this.game.state.start("Home")}}]),t}(Phaser.State);n["default"]=h},{"../prefabs/balloon":2,"../utils":16}],14:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=e("../session"),c=o(u),l=e("../scene"),h=o(l),f=function(e){function t(){return r(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),s(t,[{key:"create",value:function(){var e=new c["default"]({state:this}),t=new h["default"]({delegate:this,session:e});if(this.session=e,this.scene=t,otsimo.kv.play_screen.background_color&&(this.game.stage.backgroundColor=otsimo.kv.play_screen.background_color),otsimo.kv.play_screen.background_image){var n=this.game.add.image(this.game.world.centerX,this.game.world.centerY,otsimo.kv.play_screen.background_image);n.anchor.set(.5,.5)}this.game.add.button(25,25,"back",this.backAction,this),t.next()}},{key:"backAction",value:function(e){this.game.state.start("Home")}},{key:"render",value:function(){otsimo.debug&&(this.game.debug.text(this.game.time.fps||"--",2,14,"#00ff00"),this.session.debug(this.game))}},{key:"sceneEnded",value:function(){this.session.end(),this.game.state.start("Over")}}]),t}(Phaser.State);n["default"]=f},{"../scene":8,"../session":9}],15:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,
o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=e("../utils"),u=function(e){function t(){return o(this,t),r(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),i(t,[{key:"preload",value:function(){if(this.game.stage.backgroundColor=otsimo.kv.loading_screen.background_color,otsimo.kv.loading_screen.only_image)this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.setPreloadSprite(this.asset);else{var e=otsimo.kv.loading_screen.text,t=otsimo.kv.loading_screen.font,n=otsimo.kv.loading_screen.text_color,o=this.game.add.text(this.game.world.centerX,this.game.world.centerY,e,{font:t,fill:n});(0,s.setConstraint)(o,otsimo.kv.loading_screen.text_constraint)}this.game.sound.mute=!otsimo.sound,this.loadAssets()}},{key:"create",value:function(){otsimo.debug&&(this.game.time.advancedTiming=!0),this.game.state.start("Home")}},{key:"loadAssets",value:function(){var e=this.game.load,t=!0,n=!1,o=void 0;try{for(var r,a=otsimo.kv.preload[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var i=r.value;"atlas"===i.type?e.atlas(i.name,i.path,i.data):e[i.type](i.name,i.path)}}catch(s){n=!0,o=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw o}}}}]),t}(Phaser.State);n["default"]=u},{"../utils":16}],16:[function(e,t,n){"use strict";function o(e,t){e.x=t.x.multiplier*otsimo.game.width+t.x.constant,e.y=t.y.multiplier*otsimo.game.height+t.y.constant,t.anchor&&(e.anchor=t.anchor)}function r(e){var t=0|e.x.constant,n=0|e.y.constant,o=e.x.multiplier*otsimo.game.width+t,r=e.y.multiplier*otsimo.game.height+n;return{x:o,y:r,anchor:e.anchor}}Object.defineProperty(n,"__esModule",{value:!0}),n.setConstraint=o,n.calculateConstraint=r},{}]},{},[1]);